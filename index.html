<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>What If I Invested?</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; padding: 0 10px; }
    h1 { text-align: center; }
    form { display: grid; gap: 10px; }
    label { display: block; margin-bottom: 5px; }
    input[type="number"], select { width: 100px; }
    input[type="range"] { width: 200px; }
    button { padding: 10px; background: #28a745; color: white; border: none; cursor: pointer; }
    button:hover { background: #218838; }
    canvas { margin-top: 20px; border: 1px solid #ccc; }
    #results { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>What If I Invested?</h1>
  <form>
    <label>Amount (€): <input type="number" id="amount" value="30" min="0" step="0.01"></label>
    <label>
      <input type="checkbox" id="recurring" onclick="toggleRecurring()"> Recurring
      <select id="frequency" disabled>
        <option value="365">Daily</option>
        <option value="52">Weekly</option>
        <option value="12" selected>Monthly</option>
      </select>
    </label>
    <label>Years: <input type="range" id="years" min="5" max="50" value="40" oninput="updateYears()"></label>
    <span id="years-value">40</span>
    <label>Annual Return (%): <input type="number" id="return" value="8" min="0" step="0.1"></label>
    <label>
      <input type="checkbox" id="inflation" onclick="toggleInflation()"> Adjust for Inflation
      <input type="number" id="inflation-rate" value="2" min="0" step="0.1" disabled>
    </label>
    <label>
      <input type="checkbox" id="tax" onclick="toggleTax()"> Adjust for Tax
      <input type="number" id="tax-rate" value="25" min="0" step="0.1" disabled>
    </label>
    <button type="button" onclick="calculate()">Calculate</button>
  </form>
  <div id="results">
    <h2>Results</h2>
    <p>Nominal Value: <span id="nominal">-</span></p>
    <p id="real" style="display:none">Real Value: <span id="real-value">-</span></p>
    <p id="after-tax" style="display:none">After-Tax Value: <span id="after-tax-value">-</span></p>
  </div>
  <canvas id="chart" width="300" height="150"></canvas>

  <script>
    // Future value of a single payment
    function fv(pv, rate, years) {
      return pv * (1 + rate) ** years;
    }

    // Future value of recurring payments
    function fvSeries(pmt, rate, years, freq) {
      const r = rate / freq;
      const n = years * freq;
      return pmt * ((1 + r) ** n - 1) / r;
    }

    // Toggle recurring frequency dropdown
    function toggleRecurring() {
      const recurring = document.getElementById('recurring').checked;
      document.getElementById('frequency').disabled = !recurring;
    }

    // Toggle inflation input
    function toggleInflation() {
      const inflation = document.getElementById('inflation').checked;
      document.getElementById('inflation-rate').disabled = !inflation;
    }

    // Toggle tax input
    function toggleTax() {
      const tax = document.getElementById('tax').checked;
      document.getElementById('tax-rate').disabled = !tax;
    }

    // Update years display
    function updateYears() {
      const years = document.getElementById('years').value;
      document.getElementById('years-value').textContent = years;
    }

    // Calculate and display results
    function calculate() {
      const amount = parseFloat(document.getElementById('amount').value) || 0;
      const years = parseInt(document.getElementById('years').value) || 40;
      const returnRate = parseFloat(document.getElementById('return').value) / 100 || 0.08;
      const isRecurring = document.getElementById('recurring').checked;
      const frequency = parseInt(document.getElementById('frequency').value) || 12;
      const inflation = document.getElementById('inflation').checked;
      const inflationRate = parseFloat(document.getElementById('inflation-rate').value) / 100 || 0.02;
      const tax = document.getElementById('tax').checked;
      const taxRate = parseFloat(document.getElementById('tax-rate').value) / 100 || 0.25;

      // Calculate nominal value
      let nominal;
      if (isRecurring) {
        nominal = fvSeries(amount, returnRate, years, frequency);
      } else {
        nominal = fv(amount, returnRate, years);
      }

      // Adjust for inflation (real value)
      let real = nominal;
      if (inflation) {
        const inflationFV = fv(1, inflationRate, years);
        real = nominal / inflationFV;
      }

      // Adjust for tax (simplified: tax on final value)
      let afterTax = nominal;
      if (tax) {
        const taxAmount = nominal * taxRate;
        afterTax = nominal - taxAmount;
      }

      // Display results
      document.getElementById('nominal').textContent = `€${nominal.toFixed(2)}`;
      document.getElementById('real').style.display = inflation ? 'block' : 'none';
      document.getElementById('real-value').textContent = `€${real.toFixed(2)}`;
      document.getElementById('after-tax').style.display = tax ? 'block' : 'none';
      document.getElementById('after-tax-value').textContent = `€${afterTax.toFixed(2)}`;

      // Draw chart
      drawChart(nominal, years, isRecurring, amount, returnRate, frequency);
    }

    // Draw simple line chart
    function drawChart(nominal, years, isRecurring, amount, rate, freq) {
      const canvas = document.getElementById('chart');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const maxValue = nominal * 1.2; // Add padding
      const points = [];
      for (let y = 0; y <= years; y += years / 10) {
        let value = isRecurring ? fvSeries(amount, rate, y, freq) : fv(amount, rate, y);
        points.push({ x: y, y: value });
      }

      ctx.beginPath();
      ctx.strokeStyle = '#28a745';
      ctx.lineWidth = 2;
      points.forEach((point, i) => {
        const x = (point.x / years) * canvas.width;
        const y = canvas.height - (point.y / maxValue) * canvas.height;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();

      // Draw axes
      ctx.beginPath();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 1;
      ctx.moveTo(0, canvas.height); ctx.lineTo(0, 0); ctx.lineTo(canvas.width, 0);
      ctx.stroke();
    }
  </script>
</body>
</html>